"use strict";(self.webpackChunkmyblog=self.webpackChunkmyblog||[]).push([[20565],{96057:(n,s,a)=>{a.r(s),a.d(s,{default:()=>W});var e=a(60329);const t=(0,e._)("code",null,"commitRoot",-1),o=(0,e._)("code",null,"commité˜¶æ®µ",-1),c=(0,e._)("code",null,"fiberRootNode",-1),p=(0,e.uE)('<div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token function">commitRoot</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>åœ¨<code>rootFiber.firstEffect</code>ä¸Šä¿å­˜äº†ä¸€æ¡éœ€è¦æ‰§è¡Œ<code>å‰¯ä½œç”¨</code>çš„<code>FiberèŠ‚ç‚¹</code>çš„å•å‘é“¾è¡¨<code>effectList</code>ï¼Œè¿™äº›<code>FiberèŠ‚ç‚¹</code>çš„<code>updateQueue</code>ä¸­ä¿å­˜äº†å˜åŒ–çš„<code>props</code>ã€‚</p><p>è¿™äº›<code>å‰¯ä½œç”¨</code>å¯¹åº”çš„<code>DOMæ“ä½œ</code>åœ¨<code>commit</code>é˜¶æ®µæ‰§è¡Œã€‚</p><p>é™¤æ­¤ä¹‹å¤–ï¼Œä¸€äº›ç”Ÿå‘½å‘¨æœŸé’©å­ï¼ˆæ¯”å¦‚<code>componentDidXXX</code>ï¼‰ã€<code>hook</code>ï¼ˆæ¯”å¦‚<code>useEffect</code>ï¼‰éœ€è¦åœ¨<code>commit</code>é˜¶æ®µæ‰§è¡Œã€‚</p><p><code>commit</code>é˜¶æ®µçš„ä¸»è¦å·¥ä½œï¼ˆå³<code>Renderer</code>çš„å·¥ä½œæµç¨‹ï¼‰åˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼š</p><ul><li><p>before mutationé˜¶æ®µï¼ˆæ‰§è¡Œ<code>DOM</code>æ“ä½œå‰ï¼‰</p></li><li><p>mutationé˜¶æ®µï¼ˆæ‰§è¡Œ<code>DOM</code>æ“ä½œï¼‰</p></li><li><p>layouté˜¶æ®µï¼ˆæ‰§è¡Œ<code>DOM</code>æ“ä½œåï¼‰</p></li></ul>',6),i={href:"https://github.com/facebook/react/blob/1fb18e22ae66fdb1dc127347e169e73948778e5a/packages/react-reconciler/src/ReactFiberWorkLoop.new.js#L2001",target:"_blank",rel:"noopener noreferrer"},l=(0,e._)("code",null,"commit",-1),u=(0,e.uE)('<p>åœ¨<code>before mutationé˜¶æ®µ</code>ä¹‹å‰å’Œ<code>layouté˜¶æ®µ</code>ä¹‹åè¿˜æœ‰ä¸€äº›é¢å¤–å·¥ä½œï¼Œæ¶‰åŠåˆ°æ¯”å¦‚<code>useEffect</code>çš„è§¦å‘ã€<code>ä¼˜å…ˆçº§ç›¸å…³</code>çš„é‡ç½®ã€<code>ref</code>çš„ç»‘å®š/è§£ç»‘ã€‚</p><p>è¿™äº›å¯¹æˆ‘ä»¬å½“å‰å±äºè¶…çº²å†…å®¹ï¼Œä¸ºäº†å†…å®¹å®Œæ•´æ€§ï¼Œåœ¨è¿™èŠ‚ç®€å•ä»‹ç»ã€‚</p><h2 id="before-mutationä¹‹å‰" tabindex="-1"><a class="header-anchor" href="#before-mutationä¹‹å‰" aria-hidden="true">#</a> before mutationä¹‹å‰</h2><p><code>commitRootImpl</code>æ–¹æ³•ä¸­ç›´åˆ°ç¬¬ä¸€å¥<code>if (firstEffect !== null)</code>ä¹‹å‰å±äº<code>before mutation</code>ä¹‹å‰ã€‚</p><p>æˆ‘ä»¬å¤§ä½“çœ‹ä¸‹ä»–åšçš„å·¥ä½œï¼Œç°åœ¨ä½ è¿˜ä¸éœ€è¦ç†è§£ä»–ä»¬ï¼š</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">do</span> <span class="token punctuation">{</span>\n    <span class="token comment">// è§¦å‘useEffectå›è°ƒä¸å…¶ä»–åŒæ­¥ä»»åŠ¡ã€‚ç”±äºè¿™äº›ä»»åŠ¡å¯èƒ½è§¦å‘æ–°çš„æ¸²æŸ“ï¼Œæ‰€ä»¥è¿™é‡Œè¦ä¸€ç›´éå†æ‰§è¡Œç›´åˆ°æ²¡æœ‰ä»»åŠ¡</span>\n    <span class="token function">flushPassiveEffects</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span>rootWithPendingPassiveEffects <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n  <span class="token comment">// rootæŒ‡ fiberRootNode</span>\n  <span class="token comment">// root.finishedWorkæŒ‡å½“å‰åº”ç”¨çš„rootFiber</span>\n  <span class="token keyword">const</span> finishedWork <span class="token operator">=</span> root<span class="token punctuation">.</span>finishedWork<span class="token punctuation">;</span>\n\n  <span class="token comment">// å‡¡æ˜¯å˜é‡åå¸¦laneçš„éƒ½æ˜¯ä¼˜å…ˆçº§ç›¸å…³</span>\n  <span class="token keyword">const</span> lanes <span class="token operator">=</span> root<span class="token punctuation">.</span>finishedLanes<span class="token punctuation">;</span>\n  <span class="token keyword">if</span> <span class="token punctuation">(</span>finishedWork <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n  root<span class="token punctuation">.</span>finishedWork <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>\n  root<span class="token punctuation">.</span>finishedLanes <span class="token operator">=</span> NoLanes<span class="token punctuation">;</span>\n\n  <span class="token comment">// é‡ç½®Schedulerç»‘å®šçš„å›è°ƒå‡½æ•°</span>\n  root<span class="token punctuation">.</span>callbackNode <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>\n  root<span class="token punctuation">.</span>callbackId <span class="token operator">=</span> NoLanes<span class="token punctuation">;</span>\n\n  <span class="token keyword">let</span> remainingLanes <span class="token operator">=</span> <span class="token function">mergeLanes</span><span class="token punctuation">(</span>finishedWork<span class="token punctuation">.</span>lanes<span class="token punctuation">,</span> finishedWork<span class="token punctuation">.</span>childLanes<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token comment">// é‡ç½®ä¼˜å…ˆçº§ç›¸å…³å˜é‡</span>\n  <span class="token function">markRootFinished</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span> remainingLanes<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n  <span class="token comment">// æ¸…é™¤å·²å®Œæˆçš„discrete updatesï¼Œä¾‹å¦‚ï¼šç”¨æˆ·é¼ æ ‡ç‚¹å‡»è§¦å‘çš„æ›´æ–°ã€‚</span>\n  <span class="token keyword">if</span> <span class="token punctuation">(</span>rootsWithPendingDiscreteUpdates <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span>\n      <span class="token operator">!</span><span class="token function">hasDiscreteLanes</span><span class="token punctuation">(</span>remainingLanes<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>\n      rootsWithPendingDiscreteUpdates<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span>\n    <span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      rootsWithPendingDiscreteUpdates<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token comment">// é‡ç½®å…¨å±€å˜é‡</span>\n  <span class="token keyword">if</span> <span class="token punctuation">(</span>root <span class="token operator">===</span> workInProgressRoot<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    workInProgressRoot <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>\n    workInProgress <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>\n    workInProgressRootRenderLanes <span class="token operator">=</span> NoLanes<span class="token punctuation">;</span>\n  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token comment">// å°†effectListèµ‹å€¼ç»™firstEffect</span>\n  <span class="token comment">// ç”±äºæ¯ä¸ªfiberçš„effectListåªåŒ…å«ä»–çš„å­å­™èŠ‚ç‚¹</span>\n  <span class="token comment">// æ‰€ä»¥æ ¹èŠ‚ç‚¹å¦‚æœæœ‰effectTagåˆ™ä¸ä¼šè¢«åŒ…å«è¿›æ¥</span>\n  <span class="token comment">// æ‰€ä»¥è¿™é‡Œå°†æœ‰effectTagçš„æ ¹èŠ‚ç‚¹æ’å…¥åˆ°effectListå°¾éƒ¨</span>\n  <span class="token comment">// è¿™æ ·æ‰èƒ½ä¿è¯æœ‰effectçš„fiberéƒ½åœ¨effectListä¸­</span>\n  <span class="token keyword">let</span> firstEffect<span class="token punctuation">;</span>\n  <span class="token keyword">if</span> <span class="token punctuation">(</span>finishedWork<span class="token punctuation">.</span>effectTag <span class="token operator">&gt;</span> PerformedWork<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span>finishedWork<span class="token punctuation">.</span>lastEffect <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      finishedWork<span class="token punctuation">.</span>lastEffect<span class="token punctuation">.</span>nextEffect <span class="token operator">=</span> finishedWork<span class="token punctuation">;</span>\n      firstEffect <span class="token operator">=</span> finishedWork<span class="token punctuation">.</span>firstEffect<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n      firstEffect <span class="token operator">=</span> finishedWork<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n    <span class="token comment">// æ ¹èŠ‚ç‚¹æ²¡æœ‰effectTag</span>\n    firstEffect <span class="token operator">=</span> finishedWork<span class="token punctuation">.</span>firstEffect<span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯ä»¥çœ‹åˆ°ï¼Œ<code>before mutation</code>ä¹‹å‰ä¸»è¦åšä¸€äº›å˜é‡èµ‹å€¼ï¼ŒçŠ¶æ€é‡ç½®çš„å·¥ä½œã€‚</p><p>è¿™ä¸€é•¿ä¸²ä»£ç æˆ‘ä»¬åªéœ€è¦å…³æ³¨æœ€åèµ‹å€¼çš„<code>firstEffect</code>ï¼Œåœ¨<code>commit</code>çš„ä¸‰ä¸ªå­é˜¶æ®µéƒ½ä¼šç”¨åˆ°ä»–ã€‚</p><h2 id="layoutä¹‹å" tabindex="-1"><a class="header-anchor" href="#layoutä¹‹å" aria-hidden="true">#</a> layoutä¹‹å</h2><p>æ¥ä¸‹æ¥è®©æˆ‘ä»¬ç®€å•çœ‹ä¸‹<code>layout</code>é˜¶æ®µæ‰§è¡Œå®Œåçš„ä»£ç ï¼Œç°åœ¨ä½ è¿˜ä¸éœ€è¦ç†è§£ä»–ä»¬ï¼š</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> rootDidHavePassiveEffects <span class="token operator">=</span> rootDoesHavePassiveEffects<span class="token punctuation">;</span>\n\n<span class="token comment">// useEffectç›¸å…³</span>\n<span class="token keyword">if</span> <span class="token punctuation">(</span>rootDoesHavePassiveEffects<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  rootDoesHavePassiveEffects <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>\n  rootWithPendingPassiveEffects <span class="token operator">=</span> root<span class="token punctuation">;</span>\n  pendingPassiveEffectsLanes <span class="token operator">=</span> lanes<span class="token punctuation">;</span>\n  pendingPassiveEffectsRenderPriority <span class="token operator">=</span> renderPriorityLevel<span class="token punctuation">;</span>\n<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n\n<span class="token comment">// æ€§èƒ½ä¼˜åŒ–ç›¸å…³</span>\n<span class="token keyword">if</span> <span class="token punctuation">(</span>remainingLanes <span class="token operator">!==</span> NoLanes<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">if</span> <span class="token punctuation">(</span>enableSchedulerTracing<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// ...</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n  <span class="token comment">// ...</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// æ€§èƒ½ä¼˜åŒ–ç›¸å…³</span>\n<span class="token keyword">if</span> <span class="token punctuation">(</span>enableSchedulerTracing<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>rootDidHavePassiveEffects<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// ...</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// ...æ£€æµ‹æ— é™å¾ªç¯çš„åŒæ­¥ä»»åŠ¡</span>\n<span class="token keyword">if</span> <span class="token punctuation">(</span>remainingLanes <span class="token operator">===</span> SyncLane<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token comment">// ...</span>\n<span class="token punctuation">}</span> \n\n<span class="token comment">// åœ¨ç¦»å¼€commitRootå‡½æ•°å‰è°ƒç”¨ï¼Œè§¦å‘ä¸€æ¬¡æ–°çš„è°ƒåº¦ï¼Œç¡®ä¿ä»»ä½•é™„åŠ çš„ä»»åŠ¡è¢«è°ƒåº¦</span>\n<span class="token function">ensureRootIsScheduled</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// ...å¤„ç†æœªæ•è·é”™è¯¯åŠè€ç‰ˆæœ¬é—ç•™çš„è¾¹ç•Œé—®é¢˜</span>\n\n\n<span class="token comment">// æ‰§è¡ŒåŒæ­¥ä»»åŠ¡ï¼Œè¿™æ ·åŒæ­¥ä»»åŠ¡ä¸éœ€è¦ç­‰åˆ°ä¸‹æ¬¡äº‹ä»¶å¾ªç¯å†æ‰§è¡Œ</span>\n<span class="token comment">// æ¯”å¦‚åœ¨ componentDidMount ä¸­æ‰§è¡Œ setState åˆ›å»ºçš„æ›´æ–°ä¼šåœ¨è¿™é‡Œè¢«åŒæ­¥æ‰§è¡Œ</span>\n<span class="token comment">// æˆ–useLayoutEffect</span>\n<span class="token function">flushSyncCallbackQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>',11),r={href:"https://github.com/facebook/react/blob/1fb18e22ae66fdb1dc127347e169e73948778e5a/packages/react-reconciler/src/ReactFiberWorkLoop.new.js#L2195",target:"_blank",rel:"noopener noreferrer"},d=(0,e._)("p",null,"ä¸»è¦åŒ…æ‹¬ä¸‰ç‚¹å†…å®¹ï¼š",-1),k=(0,e._)("ol",null,[(0,e._)("li",null,[(0,e._)("code",null,"useEffect"),(0,e.Uk)("ç›¸å…³çš„å¤„ç†ã€‚")])],-1),m=(0,e._)("p",null,[(0,e.Uk)("æˆ‘ä»¬ä¼šåœ¨è®²è§£"),(0,e._)("code",null,"layouté˜¶æ®µ"),(0,e.Uk)("æ—¶è®²è§£ã€‚")],-1),v=(0,e._)("ol",{start:"2"},[(0,e._)("li",null,"æ€§èƒ½è¿½è¸ªç›¸å…³ã€‚")],-1),f=(0,e._)("code",null,"interaction",-1),b=(0,e._)("code",null,"React",-1),h={href:"https://zh-hans.reactjs.org/docs/profiler.html",target:"_blank",rel:"noopener noreferrer"},g={href:"https://github.com/facebook/react-devtools/pull/1069",target:"_blank",rel:"noopener noreferrer"},y={href:"https://gist.github.com/bvaughn/8de925562903afd2e7a12554adcdda16#overview",target:"_blank",rel:"noopener noreferrer"},w=(0,e.uE)('<ol start="3"><li>åœ¨<code>commit</code>é˜¶æ®µä¼šè§¦å‘ä¸€äº›ç”Ÿå‘½å‘¨æœŸé’©å­ï¼ˆå¦‚ <code>componentDidXXX</code>ï¼‰å’Œ<code>hook</code>ï¼ˆå¦‚<code>useLayoutEffect</code>ã€<code>useEffect</code>ï¼‰ã€‚</li></ol><p>åœ¨è¿™äº›å›è°ƒæ–¹æ³•ä¸­å¯èƒ½è§¦å‘æ–°çš„æ›´æ–°ï¼Œæ–°çš„æ›´æ–°ä¼šå¼€å¯æ–°çš„<code>render-commit</code>æµç¨‹ã€‚è€ƒè™‘å¦‚ä¸‹Demoï¼š</p>',2),E={class:"custom-container details"},_=(0,e.uE)('<summary>useLayoutEffect Demo</summary><p>åœ¨è¯¥Demoä¸­æˆ‘ä»¬ç‚¹å‡»é¡µé¢ä¸­çš„æ•°å­—ï¼ŒçŠ¶æ€ä¼šå…ˆå˜ä¸º0ï¼Œå†åœ¨<code>useLayoutEffect</code>å›è°ƒä¸­å˜ä¸ºéšæœºæ•°ã€‚ä½†åœ¨é¡µé¢ä¸Šæ•°å­—ä¸ä¼šå˜ä¸º0ï¼Œè€Œæ˜¯ç›´æ¥å˜ä¸ºæ–°çš„éšæœºæ•°ã€‚</p><p>è¿™æ˜¯å› ä¸º<code>useLayoutEffect</code>ä¼šåœ¨<code>layouté˜¶æ®µ</code>åŒæ­¥æ‰§è¡Œå›è°ƒã€‚å›è°ƒä¸­æˆ‘ä»¬è§¦å‘äº†çŠ¶æ€æ›´æ–°<code>setCount(randomNum)</code>ï¼Œè¿™ä¼šé‡æ–°è°ƒåº¦ä¸€ä¸ªåŒæ­¥ä»»åŠ¡ã€‚</p><p>è¯¥ä»»åŠ¡ä¼šåœ¨åœ¨å¦‚ä¸Š<code>commitRoot</code>å€’æ•°ç¬¬äºŒè¡Œä»£ç å¤„è¢«åŒæ­¥æ‰§è¡Œã€‚</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token function">flushSyncCallbackQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>æ‰€ä»¥æˆ‘ä»¬çœ‹ä¸åˆ°é¡µé¢ä¸­å…ƒç´ å…ˆå˜ä¸º0ã€‚</p><p>å¦‚æœæ¢æˆ<code>useEffect</code>å¤šç‚¹å‡»å‡ æ¬¡å°±èƒ½çœ‹åˆ°åŒºåˆ«ã€‚</p>',7),L=(0,e._)("strong",null,"908",-1),U={},W=(0,a(13860).Z)(U,[["render",function(n,s){const a=(0,e.up)("RouterLink"),U=(0,e.up)("ExternalLinkIcon");return(0,e.wg)(),(0,e.iD)("div",null,[(0,e._)("p",null,[(0,e.Uk)("ä¸Šä¸€ç« "),(0,e.Wm)(a,{to:"/react/process/completeWork.html#%E6%B5%81%E7%A8%8B%E7%BB%93%E5%B0%BE"},{default:(0,e.w5)((()=>[(0,e.Uk)("æœ€åä¸€èŠ‚")])),_:1}),(0,e.Uk)("æˆ‘ä»¬ä»‹ç»äº†ï¼Œ"),t,(0,e.Uk)("æ–¹æ³•æ˜¯"),o,(0,e.Uk)("å·¥ä½œçš„èµ·ç‚¹ã€‚"),c,(0,e.Uk)("ä¼šä½œä¸ºä¼ å‚ã€‚")]),p,(0,e._)("p",null,[(0,e.Uk)("ä½ å¯ä»¥ä»"),(0,e._)("a",i,[(0,e.Uk)("è¿™é‡Œ"),(0,e.Wm)(U)]),(0,e.Uk)("çœ‹åˆ°"),l,(0,e.Uk)("é˜¶æ®µçš„å®Œæ•´ä»£ç ")]),u,(0,e._)("blockquote",null,[(0,e._)("p",null,[(0,e.Uk)("ä½ å¯ä»¥åœ¨"),(0,e._)("a",r,[(0,e.Uk)("è¿™é‡Œ"),(0,e.Wm)(U)]),(0,e.Uk)("çœ‹åˆ°è¿™æ®µä»£ç ")])]),d,k,m,v,(0,e._)("p",null,[(0,e.Uk)("æºç é‡Œæœ‰å¾ˆå¤šå’Œ"),f,(0,e.Uk)("ç›¸å…³çš„å˜é‡ã€‚ä»–ä»¬éƒ½å’Œè¿½è¸ª"),b,(0,e.Uk)("æ¸²æŸ“æ—¶é—´ã€æ€§èƒ½ç›¸å…³ï¼Œåœ¨"),(0,e._)("a",h,[(0,e.Uk)("Profiler API"),(0,e.Wm)(U)]),(0,e.Uk)("å’Œ"),(0,e._)("a",g,[(0,e.Uk)("DevTools"),(0,e.Wm)(U)]),(0,e.Uk)("ä¸­ä½¿ç”¨ã€‚")]),(0,e._)("blockquote",null,[(0,e._)("p",null,[(0,e.Uk)("ä½ å¯ä»¥åœ¨è¿™é‡Œçœ‹åˆ°"),(0,e._)("a",y,[(0,e.Uk)("interactionçš„å®šä¹‰"),(0,e.Wm)(U)])])]),w,(0,e._)("details",E,[_,(0,e._)("p",null,[(0,e.Wm)(a,{to:"/react/me.html"},{default:(0,e.w5)((()=>[(0,e.Uk)("å…³æ³¨å…¬ä¼—å·")])),_:1}),(0,e.Uk)("ï¼Œåå°å›å¤"),L,(0,e.Uk)("è·å¾—åœ¨çº¿Demoåœ°å€")])])])}]])},13860:(n,s)=>{s.Z=(n,s)=>{const a=n.__vccOpts||n;for(const[n,e]of s)a[n]=e;return a}},47578:(n,s,a)=>{a.r(s),a.d(s,{data:()=>e});const e=JSON.parse('{"key":"v-dce3ba56","path":"/react/renderer/prepare.html","title":"æµç¨‹æ¦‚è§ˆ","lang":"zh-CN","frontmatter":{"title":"æµç¨‹æ¦‚è§ˆ","author":"BetaSu","tag":["React"],"summary":"ä¸Šä¸€ç« æœ€åä¸€èŠ‚æˆ‘ä»¬ä»‹ç»äº†ï¼ŒcommitRootæ–¹æ³•æ˜¯commité˜¶æ®µå·¥ä½œçš„èµ·ç‚¹ã€‚fiberRootNodeä¼šä½œä¸ºä¼ å‚ã€‚ åœ¨rootFiber.firstEffectä¸Šä¿å­˜äº†ä¸€æ¡éœ€è¦æ‰§è¡Œå‰¯ä½œç”¨çš„FiberèŠ‚ç‚¹çš„å•å‘é“¾è¡¨effectListï¼Œè¿™äº›FiberèŠ‚ç‚¹çš„updateQueueä¸­ä¿å­˜äº†å˜åŒ–çš„propsã€‚ è¿™äº›å‰¯ä½œç”¨å¯¹åº”çš„DOMæ“ä½œåœ¨commité˜¶æ®µæ‰§è¡Œã€‚ ","head":[["meta",{"property":"og:url","content":"https://0808200.xyz/react/renderer/prepare.html"}],["meta",{"property":"og:site_name","content":"ğ‘€ğ‘Ÿ.ğ‘”ğ‘œğ‘œğ‘”ğ‘¥â„"}],["meta",{"property":"og:title","content":"æµç¨‹æ¦‚è§ˆ"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:updated_time","content":"2022-08-29T09:14:21.000Z"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"article:author","content":"BetaSu"}],["meta",{"property":"article:tag","content":"React"}],["meta",{"property":"article:modified_time","content":"2022-08-29T09:14:21.000Z"}]]},"excerpt":"","headers":[{"level":2,"title":"before mutationä¹‹å‰","slug":"before-mutationä¹‹å‰","children":[]},{"level":2,"title":"layoutä¹‹å","slug":"layoutä¹‹å","children":[]}],"git":{"createdTime":1661764461000,"updatedTime":1661764461000,"contributors":[{"name":"googxh","email":"gxh522@qq.com","commits":1}]},"readingTime":{"minutes":3.95,"words":1186},"filePathRelative":"react/renderer/prepare.md","localizedDate":"2022å¹´8æœˆ29æ—¥"}')}}]);