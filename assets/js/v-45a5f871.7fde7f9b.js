"use strict";(self.webpackChunkmyblog=self.webpackChunkmyblog||[]).push([[73047],{48313:(n,s,a)=>{a.r(s),a.d(s,{default:()=>o});var e=a(78e3);const t=[(0,e.uE)('<h1 id="render" tabindex="-1"><a class="header-anchor" href="#render" aria-hidden="true">#</a> render</h1><p>Vue çš„ <code>_render</code> æ–¹æ³•æ˜¯å®ä¾‹çš„ä¸€ä¸ªç§æœ‰æ–¹æ³•ï¼Œå®ƒç”¨æ¥æŠŠå®ä¾‹æ¸²æŸ“æˆä¸€ä¸ªè™šæ‹Ÿ Nodeã€‚å®ƒçš„å®šä¹‰åœ¨ <code>src/core/instance/render.js</code> æ–‡ä»¶ä¸­ï¼š</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">_render</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> VNode <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> <span class="token literal-property property">vm</span><span class="token operator">:</span> Component <span class="token operator">=</span> <span class="token keyword">this</span>\n  <span class="token keyword">const</span> <span class="token punctuation">{</span> render<span class="token punctuation">,</span> _parentVnode <span class="token punctuation">}</span> <span class="token operator">=</span> vm<span class="token punctuation">.</span>$options\n\n  <span class="token comment">// reset _rendered flag on slots for duplicate slot check</span>\n  <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">!==</span> <span class="token string">&#39;production&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">in</span> vm<span class="token punctuation">.</span>$slots<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token comment">// $flow-disable-line</span>\n      vm<span class="token punctuation">.</span>$slots<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">.</span>_rendered <span class="token operator">=</span> <span class="token boolean">false</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token keyword">if</span> <span class="token punctuation">(</span>_parentVnode<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    vm<span class="token punctuation">.</span>$scopedSlots <span class="token operator">=</span> _parentVnode<span class="token punctuation">.</span>data<span class="token punctuation">.</span>scopedSlots <span class="token operator">||</span> emptyObject\n  <span class="token punctuation">}</span>\n\n  <span class="token comment">// set parent vnode. this allows render functions to have access</span>\n  <span class="token comment">// to the data on the placeholder node.</span>\n  vm<span class="token punctuation">.</span>$vnode <span class="token operator">=</span> _parentVnode\n  <span class="token comment">// render self</span>\n  <span class="token keyword">let</span> vnode\n  <span class="token keyword">try</span> <span class="token punctuation">{</span>\n    vnode <span class="token operator">=</span> <span class="token function">render</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>vm<span class="token punctuation">.</span>_renderProxy<span class="token punctuation">,</span> vm<span class="token punctuation">.</span>$createElement<span class="token punctuation">)</span>\n  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token function">handleError</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> vm<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">render</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>\n    <span class="token comment">// return error render result,</span>\n    <span class="token comment">// or previous vnode to prevent render error causing blank component</span>\n    <span class="token comment">/* istanbul ignore else */</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">!==</span> <span class="token string">&#39;production&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">if</span> <span class="token punctuation">(</span>vm<span class="token punctuation">.</span>$options<span class="token punctuation">.</span>renderError<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">try</span> <span class="token punctuation">{</span>\n          vnode <span class="token operator">=</span> vm<span class="token punctuation">.</span>$options<span class="token punctuation">.</span><span class="token function">renderError</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>vm<span class="token punctuation">.</span>_renderProxy<span class="token punctuation">,</span> vm<span class="token punctuation">.</span>$createElement<span class="token punctuation">,</span> e<span class="token punctuation">)</span>\n        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n          <span class="token function">handleError</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> vm<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">renderError</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>\n          vnode <span class="token operator">=</span> vm<span class="token punctuation">.</span>_vnode\n        <span class="token punctuation">}</span>\n      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n        vnode <span class="token operator">=</span> vm<span class="token punctuation">.</span>_vnode\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n      vnode <span class="token operator">=</span> vm<span class="token punctuation">.</span>_vnode\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n  <span class="token comment">// return empty vnode in case the render function errored out</span>\n  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>vnode <span class="token keyword">instanceof</span> <span class="token class-name">VNode</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">!==</span> <span class="token string">&#39;production&#39;</span> <span class="token operator">&amp;&amp;</span> Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>vnode<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token function">warn</span><span class="token punctuation">(</span>\n        <span class="token string">&#39;Multiple root nodes returned from render function. Render function &#39;</span> <span class="token operator">+</span>\n        <span class="token string">&#39;should return a single root node.&#39;</span><span class="token punctuation">,</span>\n        vm\n      <span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n    vnode <span class="token operator">=</span> <span class="token function">createEmptyVNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n  <span class="token punctuation">}</span>\n  <span class="token comment">// set parent</span>\n  vnode<span class="token punctuation">.</span>parent <span class="token operator">=</span> _parentVnode\n  <span class="token keyword">return</span> vnode\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç æœ€å…³é”®çš„æ˜¯ <code>render</code> æ–¹æ³•çš„è°ƒç”¨ï¼Œæˆ‘ä»¬åœ¨å¹³æ—¶çš„å¼€å‘å·¥ä½œä¸­æ‰‹å†™ <code>render</code> æ–¹æ³•çš„åœºæ™¯æ¯”è¾ƒå°‘ï¼Œè€Œå†™çš„æ¯”è¾ƒå¤šçš„æ˜¯ <code>template</code> æ¨¡æ¿ï¼Œåœ¨ä¹‹å‰çš„ <code>mounted</code> æ–¹æ³•çš„å®ç°ä¸­ï¼Œä¼šæŠŠ <code>template</code> ç¼–è¯‘æˆ <code>render</code> æ–¹æ³•ï¼Œä½†è¿™ä¸ªç¼–è¯‘è¿‡ç¨‹æ˜¯éå¸¸å¤æ‚çš„ï¼Œæˆ‘ä»¬ä¸æ‰“ç®—åœ¨è¿™é‡Œå±•å¼€è®²ï¼Œä¹‹åä¼šä¸“é—¨èŠ±ä¸€ä¸ªç« èŠ‚æ¥åˆ†æ Vue çš„ç¼–è¯‘è¿‡ç¨‹ã€‚</p><p>åœ¨ Vue çš„å®˜æ–¹æ–‡æ¡£ä¸­ä»‹ç»äº† <code>render</code> å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ <code>createElement</code>ï¼Œé‚£ä¹ˆç»“åˆä¹‹å‰çš„ä¾‹å­ï¼š</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>app<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>\n  {{ message }}\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç›¸å½“äºæˆ‘ä»¬ç¼–å†™å¦‚ä¸‹ <code>render</code> å‡½æ•°ï¼š</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token function-variable function">render</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">createElement</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> <span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&#39;div&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>\n     <span class="token literal-property property">attrs</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n        <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&#39;app&#39;</span>\n      <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>message<span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å†å›åˆ° <code>_render</code> å‡½æ•°ä¸­çš„ <code>render</code> æ–¹æ³•çš„è°ƒç”¨ï¼š</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>vnode <span class="token operator">=</span> <span class="token function">render</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>vm<span class="token punctuation">.</span>_renderProxy<span class="token punctuation">,</span> vm<span class="token punctuation">.</span>$createElement<span class="token punctuation">)</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>å¯ä»¥çœ‹åˆ°ï¼Œ<code>render</code> å‡½æ•°ä¸­çš„ <code>createElement</code> æ–¹æ³•å°±æ˜¯ <code>vm.$createElement</code> æ–¹æ³•ï¼š</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">initRender</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">vm</span><span class="token operator">:</span> Component</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token comment">// ...</span>\n  <span class="token comment">// bind the createElement fn to this instance</span>\n  <span class="token comment">// so that we get proper render context inside it.</span>\n  <span class="token comment">// args order: tag, data, children, normalizationType, alwaysNormalize</span>\n  <span class="token comment">// internal version is used by render functions compiled from templates</span>\n  vm<span class="token punctuation">.</span><span class="token function-variable function">_c</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">createElement</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>\n  <span class="token comment">// normalization is always applied for the public version, used in</span>\n  <span class="token comment">// user-written render functions.</span>\n  vm<span class="token punctuation">.</span><span class="token function-variable function">$createElement</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">createElement</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å®é™…ä¸Šï¼Œ<code>vm.$createElement</code> æ–¹æ³•å®šä¹‰æ˜¯åœ¨æ‰§è¡Œ <code>initRender</code> æ–¹æ³•çš„æ—¶å€™ï¼Œå¯ä»¥çœ‹åˆ°é™¤äº† <code>vm.$createElement</code> æ–¹æ³•ï¼Œè¿˜æœ‰ä¸€ä¸ª <code>vm._c</code> æ–¹æ³•ï¼Œå®ƒæ˜¯è¢«æ¨¡æ¿ç¼–è¯‘æˆçš„ <code>render</code> å‡½æ•°ä½¿ç”¨ï¼Œè€Œ <code>vm.$createElement</code> æ˜¯ç”¨æˆ·æ‰‹å†™ <code>render</code> æ–¹æ³•ä½¿ç”¨çš„ï¼Œ è¿™ä¿©ä¸ªæ–¹æ³•æ”¯æŒçš„å‚æ•°ç›¸åŒï¼Œå¹¶ä¸”å†…éƒ¨éƒ½è°ƒç”¨äº† <code>createElement</code> æ–¹æ³•ã€‚</p><h2 id="æ€»ç»“" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“" aria-hidden="true">#</a> æ€»ç»“</h2><p><code>vm._render</code> æœ€ç»ˆæ˜¯é€šè¿‡æ‰§è¡Œ <code>createElement</code> æ–¹æ³•å¹¶è¿”å›çš„æ˜¯ <code>vnode</code>ï¼Œå®ƒæ˜¯ä¸€ä¸ªè™šæ‹Ÿ Nodeã€‚Vue 2.0 ç›¸æ¯” Vue 1.0 æœ€å¤§çš„å‡çº§å°±æ˜¯åˆ©ç”¨äº† Virtual DOMã€‚å› æ­¤åœ¨åˆ†æ <code>createElement</code> çš„å®ç°å‰ï¼Œæˆ‘ä»¬å…ˆäº†è§£ä¸€ä¸‹ Virtual DOM çš„æ¦‚å¿µã€‚</p>',15)],p={},o=(0,a(13860).Z)(p,[["render",function(n,s){return(0,e.wg)(),(0,e.iD)("div",null,t)}]])},13860:(n,s)=>{s.Z=(n,s)=>{const a=n.__vccOpts||n;for(const[n,e]of s)a[n]=e;return a}},8930:(n,s,a)=>{a.r(s),a.d(s,{data:()=>e});const e=JSON.parse('{"key":"v-45a5f871","path":"/vue2/data-driven/render.html","title":"render","lang":"zh-CN","frontmatter":{"author":"ustbhuangyi","summary":"render Vue çš„ _render æ–¹æ³•æ˜¯å®ä¾‹çš„ä¸€ä¸ªç§æœ‰æ–¹æ³•ï¼Œå®ƒç”¨æ¥æŠŠå®ä¾‹æ¸²æŸ“æˆä¸€ä¸ªè™šæ‹Ÿ Nodeã€‚å®ƒçš„å®šä¹‰åœ¨ src/core/instance/render.js æ–‡ä»¶ä¸­ï¼š è¿™æ®µä»£ç æœ€å…³é”®çš„æ˜¯ render æ–¹æ³•çš„è°ƒç”¨ï¼Œæˆ‘ä»¬åœ¨å¹³æ—¶çš„å¼€å‘å·¥ä½œä¸­æ‰‹å†™ render æ–¹æ³•çš„åœºæ™¯æ¯”è¾ƒå°‘ï¼Œè€Œå†™çš„æ¯”è¾ƒå¤šçš„æ˜¯ template æ¨¡æ¿ï¼Œåœ¨ä¹‹å‰çš„ mounted æ–¹","head":[["meta",{"property":"og:url","content":"https://0808200.xyz/vue2/data-driven/render.html"}],["meta",{"property":"og:site_name","content":"ğ‘€ğ‘Ÿ.ğºğ‘œğ‘œğ‘”ğ‘¥â„"}],["meta",{"property":"og:title","content":"render"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:updated_time","content":"2022-08-29T09:14:21.000Z"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"article:author","content":"ustbhuangyi"}],["meta",{"property":"article:modified_time","content":"2022-08-29T09:14:21.000Z"}]]},"excerpt":"","headers":[{"level":2,"title":"æ€»ç»“","slug":"æ€»ç»“","children":[]}],"git":{"createdTime":1661764461000,"updatedTime":1661764461000,"contributors":[{"name":"googxh","email":"gxh522@qq.com","commits":1}]},"readingTime":{"minutes":2.19,"words":657},"filePathRelative":"vue2/data-driven/render.md","localizedDate":"2022å¹´8æœˆ29æ—¥"}')}}]);